{% extends 'layout.twig' %}

{% block body %}
    <div class="row">
        <div class="col-sm-12 text-center">
            <h3 class="section-title title">
                Carrito de compras
            </h3>
        </div>

        {% if not cart or cart.items|length == 0 %}
            No hay productos en el carrito.
        {% else %}
            <div class="row cart">
                <div class="col-sm-12">
                    <table class="table table-responsive cart__resume-table">
                        <thead>
                            <tr>
                                <th>Producto</th>
                                <th>Descripcion</th>
                                <th>Cantidad</th>
                                <th>Precio</th>
                                <th>Total</th>
                                <th>Eliminar</th>
                            </tr>
                        </thead>
                        <tbody>
                        {% for item in cart.items %}
                            <tr>
                                <td>
                                    <img src="{{ item.sku.image.url }}?w=48" alt="">
                                </td>
                                <td>
                                    <a class="cart__resume-table__product-name" href="/productos/{{ item.product.permalink }}">{{ item.sku.full_name }}</a>
                                    <p>{{ item.product.excerpt | raw }}</p>
                                </td>
                                <td>
                                    <form action="/carrito/actualizar" method="post">
                                        <input type="hidden" name="_method" value="patch">
                                        <input type="hidden" name="id" value="{{ item.id }}">
                                        <select class="cart__resume-table__product-quantity" name="quantity">
                                            {% for qty in 1..5 %}
                                                <option value="{{ qty }}"{{ qty == item.quantity ? ' selected="selected"' : null }}>{{ qty }}</option>
                                            {% endfor %}
                                        </select>
                                        <button class="btn btn-link" type="submit"><span class="mdi mdi-pencil"></span></button>
                                    </form>
                                </td>
                                <td class="cart__resume-table__product-amount">
                                    {{ item.price | money('symbol', 'code') }}
                                </td>
                                <td class="cart__resume-table__product-amount">
                                    {{ item.total | money('symbol', 'code') }}
                                </td>
                                <td class="cart__resume-table__product-amount">
                                    <form action="/carrito/eliminar" method="post" class="text-center">
                                        <input type="hidden" name="_method" value="delete">
                                        <input type="hidden" name="id" value="{{ item.id }}">
                                        <input type="hidden" name="quantity" value="0">
                                        <button type="submit" class="cart__resume-table__product-remove"><span class="mdi mdi-delete"></span></button>
                                    </form>
                                </td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="row cart-total-row">
                <div class="col-sm-6 pull-right">
                    <div class="row">
                        <div class="col-sm-6 text-right">
                            <h5 class="cart-total-row__subtitle">Total de productos:</h5>
                        </div>
                        <div class="col-sm-6 text-right">
                            <h5 class="cart-total-row__subtitle">{{ cart.total_items }}</h5>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-sm-6 text-right">
                            <h3 class="cart-total-row__title">TOTAL:</h3>
                        </div>
                        <div class="col-sm-6 text-right">
                            <h3 class="cart-total-row__title">{{ cart.total_price | money('symbol', 'code') }}</h3>
                        </div>
                    </div>

                    <div class="pull-right">
                        <ul>
                            <li><h5>IVA inclu√≠do</h5></li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-sm-12">
                    <div class="pull-left">
                        <a href="/productos" class="btn btn-lg text-uppercase">Seguir comprando</a>
                    </div>
                    <div class="pull-right">
                        <a href="/checkout" class="btn btn-lg text-uppercase">Continuar</a>
                    </div>
                </div>
            </div>
        {% endif %}
    </div>
{% endblock body %}
